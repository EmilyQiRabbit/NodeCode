webpackJsonp([3],{1321:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Users=void 0;var i=(n(154),n(153)),s=r(i),l=(n(115),n(92)),c=r(l),f=(n(156),n(155)),d=r(f),p=(n(114),n(113)),h=r(p),m=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_=n(0),g=r(_),y=n(5),b=r(y),v=n(48),E=n(59),U=n(1346),x=r(U),w=n(151),O=r(w),A=n(255),S=t.Users=function(e){function t(e){o(this,t);var n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getUserList=function(e){var t=n.props,r=t.appActions,o=t.userActions;r.loading(!0).then(function(){return o.getList({page:e})}).then(function(){r.loading(!1)}).catch(function(e){h.default.error(e.msg)})},n.handleUserFroze=function(e,t){n.props.userActions.postFrozeUser({index:t,_id:e._id,user_status:1===e.user_status?0:1}).then(function(t){var n=0===e.user_status?"激活":"禁用";h.default.success(n+"成功")}).catch(function(e){h.default.error(e.msg)})},n.handleUserRole=function(e,t){n.props.userActions.postRoleUser({index:t,_id:e._id,user_role:999===e.user_role?1:999}).then(function(e){h.default.success("权限更改成功")}).catch(function(e){h.default.error(e.msg)})},n.handleUserDelete=function(e,t){n.props.userActions.postDeleteUser({index:t,_id:e._id}).then(function(e){h.default.success("删除成功")}).catch(function(e){h.default.error(e.msg)})},n.handleTableChange=function(e){n.getUserList(e.current)},n.columns=[{title:"姓名",width:150,dataIndex:"userName",key:"realname"},{title:"邮箱",width:150,dataIndex:"email",key:"email"},{title:"注册时间",width:200,dataIndex:"createTime",key:"register",render:function(e){return(0,A.dateToString)(e)}},{title:"状态",dataIndex:"user_status",key:"status",render:function(e,t){var n={text:"正常",color:"#093"};return 0===e&&(n.text="禁用",n.color="#ff0000"),g.default.createElement("span",{style:{color:n.color}},n.text)}},{title:"权限",dataIndex:"user_role",key:"role",render:function(e,t){switch(e){case 999:return"管理员";default:return"一般用户"}}},{title:"操作",render:function(e,t,r){function o(){c.handleUserRole(t,r)}function u(){c.handleUserFroze(t,r)}function a(){c.handleUserDelete(t,r)}var i=0===t.user_status?"激活":"禁用",s="确定"+i+"此账号么?",l=999===t.user_role?"取消管理员":"设为管理员",c=n;return g.default.createElement("span",null,g.default.createElement("a",{href:"#",onClick:o},l),g.default.createElement("span",{className:"ant-divider"}),g.default.createElement(d.default,{title:s,onConfirm:u},g.default.createElement("a",{href:"#"},i)),g.default.createElement("span",{className:"ant-divider"}),g.default.createElement(d.default,{title:"确定删除此账号么?",onConfirm:a},g.default.createElement("a",{href:"#"},"删除")))}}],n}return a(t,e),m(t,[{key:"componentDidMount",value:function(){this.getUserList(1)}},{key:"render",value:function(){var e=this.props.user,t=e.get("userlist")&&e.get("userlist").toArray(),n=e.get("pagination")&&e.get("pagination").toJS();return g.default.createElement("div",null,g.default.createElement(c.default,{selectedKeys:["list"],mode:"horizontal"},g.default.createElement(c.default.Item,{key:"list"},"用户列表")),g.default.createElement(s.default,{bordered:!0,rowKey:"_id",columns:this.columns,dataSource:t,className:"mt20",pagination:n,onChange:this.handleTableChange}))}}]),t}(_.Component);S.propTypes={user:b.default.object,appActions:b.default.object,userActions:b.default.object},t.default=(0,v.connect)(function(e){return{user:e.get("user")}},function(e){return{userActions:(0,E.bindActionCreators)(x.default,e),appActions:(0,E.bindActionCreators)(O.default,e)}})(S)},1346:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(152),o=function(e){return e&&e.__esModule?e:{default:e}}(r),u=function(e){return function(t){var n="/api/user/list?page="+e.page;return o.default.get(n).then(function(e){return Promise.resolve(t({type:"USER_LIST",pagination:e.data.pagination,userlist:e.data.results}))})}},a=function(e){return function(t){return o.default.post("/api/user/delete",JSON.stringify(e)).then(function(n){return Promise.resolve(t({type:"USER_DELETE",index:e.index}))})}},i=function(e){return function(t){return o.default.post("/api/user/role",JSON.stringify(e)).then(function(n){return Promise.resolve(t({type:"USER_EDIT",index:e.index,info:n.data}))})}},s=function(e){return function(t){return o.default.post("/api/user/froze",JSON.stringify(e)).then(function(n){return Promise.resolve(t({type:"USER_EDIT",index:e.index,info:n.data}))})}};t.default={getList:u,postDeleteUser:a,postFrozeUser:s,postRoleUser:i}}});
//# sourceMappingURL=map/3.731400f6b3d6afa30f3d.js.map